(()=>{var e={};e.id=661,e.ids=[661],e.modules={6037:e=>{"use strict";e.exports=require("mongoose")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},8198:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>x,serverHooks:()=>w,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{POST:()=>g});var n=t(2706),i=t(8203),a=t(5994),o=t(9187);let u=require("bcrypt");var p=t.n(u),d=t(7914),l=t(6037);let c=new l.Schema({firstname:{type:String,required:!0,trim:!0},lastname:{type:String,required:!0,trim:!0},email:{type:String,required:!0,unique:!0,trim:!0},password:{type:String,required:!0},role:{type:String,enum:["user","admin"],default:"user"}}),m=l.models.User||(0,l.model)("User",c);async function g(e){try{let{name:r,email:t,password:s}=await e.json();if(await (0,d.A)(),await m.findOne({email:t}))return o.NextResponse.json({message:"User already exists"},{status:400});let n=await p().hash(s,10),i=await m.create({name:r,email:t,password:n});return o.NextResponse.json({message:"User registered successfully",user:{id:i._id,name:i.name,email:i.email,role:i.role}})}catch(e){return console.error("Registration error:",e),o.NextResponse.json({message:"Error registering user"},{status:500})}}let x=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/register/route",pathname:"/api/register",filename:"route",bundlePath:"app/api/register/route"},resolvedPagePath:"D:\\studio sonterra\\src\\app\\api\\register\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:v,workUnitAsyncStorage:f,serverHooks:w}=x;function y(){return(0,a.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:f})}},6487:()=>{},8335:()=>{},7914:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var s=t(6037),n=t.n(s);let i=process.env.MONGO_URL;if(!i)throw Error("Please define the MONGO_URL environment variable");let a=global.mongoose;a||(a=global.mongoose={conn:null,promise:null});let o=async function(){return a.conn||(a.promise||(a.promise=n().connect(i,{bufferCommands:!1}).then(e=>e)),a.conn=await a.promise),a.conn}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452],()=>t(8198));module.exports=s})();